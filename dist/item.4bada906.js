import{J as c,K as y,a as p}from"./index.c3b8df4f.js";import{A as d}from"./index.c4cb3088.js";const v={async create(t){return(await c.post(`${d}/items`,t)).data},async getById(t){return(await c.get(`${d}/items/${t}`)).data},async updateById(t,u){return(await c.put(`${d}/items/${t}`,u)).data},async delete(t){return(await c.delete(`${d}/items/${t}`)).data},async list(t){return(await c.get(`${d}/items?warehouse_id=1`,{params:t})).data},async listWithHistory(t){return(await c.get(`${d}/items/with-history`,{params:t})).data}},x=y("item",()=>{const t=p({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),u=p(null),n=p(!1),o=p(null),r=p(!1);return{items:t,item:u,isLoading:n,error:o,isLoaded:r,fetchItems:async(s={},i=!1)=>{var l,e;if(o.value=null,!(!i&&r.value))try{n.value=!0;const a=await v.list(s);Object.assign(t.value,{total:a.total||0,totalPages:a.totalPages||1,currentPage:s.page||1,pageSize:s.limit||10,data:a.data||[]}),r.value=!0}catch(a){o.value=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to fetch items"}finally{n.value=!1}},fetchItemsWithHistory:async(s={},i=!1)=>{var l,e;if(o.value=null,!(!i&&r.value))try{n.value=!0;const a=await v.listWithHistory(s);Object.assign(t.value,{total:a.total||0,totalPages:a.totalPages||1,currentPage:s.page||1,pageSize:s.limit||10,data:a.data||[]}),r.value=!0}catch(a){o.value=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to fetch items with history"}finally{n.value=!1}},fetchItemById:async s=>{var i,l;o.value=null;try{n.value=!0;const e=await v.getById(s);u.value=e}catch(e){o.value=((l=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to fetch item"}finally{n.value=!1}},createItem:async s=>{var i,l;o.value=null;try{n.value=!0;const e=await v.create(s);t.value.data.push(e),t.value.total+=1}catch(e){o.value=((l=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to create item"}finally{n.value=!1}},updateItem:async(s,i)=>{var l,e;o.value=null;try{n.value=!0;const a=await v.updateById(s,i),m=t.value.data.findIndex(f=>f.id===s);m!==-1&&(t.value.data[m]=a)}catch(a){o.value=((e=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to update item"}finally{n.value=!1}},deleteItem:async s=>{var i,l;o.value=null;try{n.value=!0,await v.delete(s),t.value.data=t.value.data.filter(e=>e.id!==s),t.value.total-=1}catch(e){o.value=((l=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to delete item"}finally{n.value=!1}},resetStore:()=>{t.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},u.value=null,n.value=!1,o.value=null,r.value=!1}}});export{x as u};
