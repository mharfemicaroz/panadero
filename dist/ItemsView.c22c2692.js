import{a as h,s as Q,b as u,l as r,f as g,e as w,i as e,B as n,C as d,L as b,F as p,x as f,h as c,m as C,c as B,v as z,t as _,S as L}from"./index.81ed66ed.js";import{_ as K}from"./LayoutAuthenticatedX.a0217d4b.js";import{_ as R}from"./SectionMain.ff7c0a76.js";import{u as Y}from"./item.e99833f6.js";import{u as G}from"./warehouse.a109b2e4.js";import{u as H}from"./category.bc62a0d5.js";import{_ as J}from"./NotificationBar.62c87214.js";import{B as O}from"./BaseTable.aa93a529.js";import{_ as X}from"./CardBox.d4dece43.js";import{_ as Z}from"./SectionTitleLineWithButton.9b4305a6.js";import{_ as P}from"./BaseButton.4cf3599a.js";import{p as ee,c as le,u as te,v as oe}from"./mdi.aa269c9f.js";import"./darkMode.4d354904.js";import"./BaseIcon.f7bbc3f6.js";import"./FormControl.7fdae42f.js";import"./FooterBar.223d3b14.js";import"./logo.c6f18b48.js";import"./BaseLevel.f8579f88.js";import"./index.8f8d0999.js";import"./TableCheckboxCell.5bd18b8c.js";import"./BaseButtons.e89c9a47.js";import"./_plugin-vue_export-helper.c27b6911.js";const ae={class:"flex items-center gap-2"},se={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},ne={class:"bg-white p-6 rounded shadow-lg w-[600px]"},ie=e("h2",{class:"text-xl mb-4"},"Add Item",-1),ue={class:"grid grid-cols-2 gap-4"},de=e("label",{class:"block mb-1"},"Name",-1),re=e("label",{class:"block mb-1"},"Price",-1),ce=e("label",{class:"block mb-1"},"Beginning Qty",-1),me=e("label",{class:"block mb-1"},"Cost",-1),be=e("label",{class:"block mb-1"},"SKU",-1),pe=e("label",{class:"block mb-1"},"Barcode",-1),_e=e("label",{class:"block mb-1"},"Unit of Measurement",-1),ve=e("label",{class:"block mb-1"},"Sold By",-1),ge=e("option",{value:"each"},"Each",-1),fe=e("option",{value:"weight"},"Weight",-1),ye=[ge,fe],ke={class:"col-span-2"},he=e("label",{class:"block mb-1"},"Image URL",-1),we=e("label",{class:"block mb-1"},"Warehouse",-1),xe=["value"],Ue=e("label",{class:"block mb-1"},"Category",-1),Ce=["value"],Ve={class:"col-span-2"},Ie=e("label",{class:"block mb-1"},"Subcategory",-1),Se=["value"],Be={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},Le={class:"bg-white p-6 rounded shadow-lg w-[600px]"},Pe=e("h2",{class:"text-xl mb-4"},"Edit Item",-1),Ne={class:"grid grid-cols-2 gap-4"},qe=e("label",{class:"block mb-1"},"Name",-1),Me=e("label",{class:"block mb-1"},"Price",-1),Te=e("label",{class:"block mb-1"},"Beginning Qty",-1),De=e("label",{class:"block mb-1"},"Cost",-1),Ee=e("label",{class:"block mb-1"},"SKU",-1),$e=e("label",{class:"block mb-1"},"Barcode",-1),Ae=e("label",{class:"block mb-1"},"Unit of Measurement",-1),We=e("label",{class:"block mb-1"},"Sold By",-1),je=e("option",{value:"each"},"Each",-1),Fe=e("option",{value:"weight"},"Weight",-1),Qe=[je,Fe],ze={class:"col-span-2"},Ke=e("label",{class:"block mb-1"},"Image URL",-1),Re=e("label",{class:"block mb-1"},"Warehouse",-1),Ye=["value"],Ge=e("label",{class:"block mb-1"},"Category",-1),He=["value"],Je={class:"col-span-2"},Oe=e("label",{class:"block mb-1"},"Subcategory",-1),Xe=["value"],wl={__name:"ItemsView",setup(Ze){const x=h(!1),U=h(!1),s=h({name:"",price:0,beginning_qty:0,sku:"",barcode:"",cost:0,unit_of_measurement:"",sold_by:"",image:"",warehouse_id:null,category_id:null,subcategory_id:null}),a=h({id:null,name:"",price:0,beginning_qty:0,sku:"",barcode:"",cost:0,unit_of_measurement:"",sold_by:"",image:"",warehouse_id:null,category_id:null,subcategory_id:null}),i=Y(),v=G(),m=H(),y=h([]);async function k(o={},t=!1){await i.fetchItems(o,t)}k({page:1,limit:5});const N=Q(()=>{var o,t,l,I,S;return{total:((o=i.items)==null?void 0:o.total)||0,totalPages:((t=i.items)==null?void 0:t.totalPages)||1,currentPage:((l=i.items)==null?void 0:l.currentPage)||1,pageSize:((I=i.items)==null?void 0:I.pageSize)||5,data:((S=i.items)==null?void 0:S.data)||[]}}),q=[{key:"name",label:"Name",sortable:!0,filterable:!0},{key:"price",label:"Price",sortable:!0,filterable:!0},{key:"cost",label:"Cost",sortable:!0,filterable:!0},{key:"category",label:"Category",formatter:(o,t)=>t.category?t.category.name:""},{key:"subcategory",label:"Subcategory",formatter:(o,t)=>t.subcategory?t.subcategory.name:""}],M=async o=>{await k(o,!0)},T=o=>{y.value=o},D=async o=>{var t;for(i.isLoading=!0,await Promise.all([v.fetchAll(),m.fetchItems(),m.fetchSubcategoriesByCategory((t=o.category)==null?void 0:t.id)]);v.isLoading||m.isLoading;)await new Promise(l=>setTimeout(l,100));a.value={id:o.id,name:o.name,price:o.price,beginning_qty:o.beginning_qty,sku:o.sku,barcode:o.barcode,cost:o.cost,unit_of_measurement:o.unit_of_measurement,sold_by:o.sold_by,image:o.image,warehouse_id:o.warehouse?o.warehouse.id:null,category_id:o.category?o.category.id:null,subcategory_id:o.subcategory?o.subcategory.id:null},U.value=!0,i.isLoading=!1};async function V(o){await m.fetchSubcategoriesByCategory(o)}const E=async()=>{for(i.isLoading=!0,await Promise.all([v.fetchAll(),m.fetchItems()]);v.isLoading||m.isLoading;)await new Promise(o=>setTimeout(o,100));m.subcategories=[],s.value={name:"",price:0,beginning_qty:0,sku:"",barcode:"",cost:0,unit_of_measurement:"",sold_by:"",image:"",warehouse_id:null,category_id:null,subcategory_id:null},x.value=!0,i.isLoading=!1};async function $(){await i.createItem(s.value),i.error||(x.value=!1,await k({page:1,limit:5},!0))}async function A(){await i.updateItem(a.value.id,a.value),i.error||(U.value=!1,await k({page:1,limit:5},!0))}async function W(){if(y.value.length===0)return;if((await L.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete them!"})).isConfirmed){for(const t of y.value)if(await i.deleteItem(t),i.error)break;i.error||(y.value=[],await k({page:1,limit:5},!0),L.fire("Deleted!","The items have been deleted.","success"))}}const j=()=>{x.value=!1},F=()=>{U.value=!1};return(o,t)=>(u(),r(p,null,[g(K,null,{default:w(()=>[g(R,null,{default:w(()=>[c(i).error?(u(),B(J,{key:0,icon:c(ee),color:"danger"},{default:w(()=>[z(_(c(i).error),1)]),_:1},8,["icon"])):C("",!0),g(Z,{icon:c(le),title:"Items",main:""},{default:w(()=>[e("div",ae,[g(P,{icon:c(te),color:"primary",label:"New Item",onClick:E},null,8,["icon"]),y.value.length?(u(),B(P,{key:0,icon:c(oe),color:"danger",label:"Delete",onClick:W},null,8,["icon"])):C("",!0)])]),_:1},8,["icon"]),g(X,{class:"mb-6"},{default:w(()=>[g(O,{columns:q,data:N.value,loading:c(i).isLoading,checkable:"",onQueryChange:M,onSelected:T,onEdit:D},null,8,["data","loading"])]),_:1})]),_:1})]),_:1}),x.value?(u(),r("div",se,[e("div",ne,[ie,e("div",ue,[e("div",null,[de,n(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.name=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,s.value.name]])]),e("div",null,[re,n(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.price=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,s.value.price]])]),e("div",null,[ce,n(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.beginning_qty=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,s.value.beginning_qty]])]),e("div",null,[me,n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.cost=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,s.value.cost]])]),e("div",null,[be,n(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.sku=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,s.value.sku]])]),e("div",null,[pe,n(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.barcode=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,s.value.barcode]])]),e("div",null,[_e,n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.unit_of_measurement=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,s.value.unit_of_measurement]])]),e("div",null,[ve,n(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.sold_by=l),class:"w-full border p-2 rounded"},ye,512),[[b,s.value.sold_by]])]),e("div",ke,[he,n(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.image=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,s.value.image]])]),e("div",null,[we,n(e("select",{"onUpdate:modelValue":t[9]||(t[9]=l=>s.value.warehouse_id=l),class:"w-full border p-2 rounded"},[(u(!0),r(p,null,f(c(v).warehouses,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,xe))),128))],512),[[b,s.value.warehouse_id]])]),e("div",null,[Ue,n(e("select",{"onUpdate:modelValue":t[10]||(t[10]=l=>s.value.category_id=l),class:"w-full border p-2 rounded",onChange:t[11]||(t[11]=l=>V(s.value.category_id))},[(u(!0),r(p,null,f(c(m).items.data,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,Ce))),128))],544),[[b,s.value.category_id]])]),e("div",Ve,[Ie,n(e("select",{"onUpdate:modelValue":t[12]||(t[12]=l=>s.value.subcategory_id=l),class:"w-full border p-2 rounded"},[(u(!0),r(p,null,f(c(m).subcategories,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,Se))),128))],512),[[b,s.value.subcategory_id]])])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:j},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:$},"Save")])])])):C("",!0),U.value?(u(),r("div",Be,[e("div",Le,[Pe,e("div",Ne,[e("div",null,[qe,n(e("input",{"onUpdate:modelValue":t[13]||(t[13]=l=>a.value.name=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,a.value.name]])]),e("div",null,[Me,n(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>a.value.price=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,a.value.price]])]),e("div",null,[Te,n(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>a.value.beginning_qty=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,a.value.beginning_qty]])]),e("div",null,[De,n(e("input",{"onUpdate:modelValue":t[16]||(t[16]=l=>a.value.cost=l),type:"number",class:"w-full border p-2 rounded"},null,512),[[d,a.value.cost]])]),e("div",null,[Ee,n(e("input",{"onUpdate:modelValue":t[17]||(t[17]=l=>a.value.sku=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,a.value.sku]])]),e("div",null,[$e,n(e("input",{"onUpdate:modelValue":t[18]||(t[18]=l=>a.value.barcode=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,a.value.barcode]])]),e("div",null,[Ae,n(e("input",{"onUpdate:modelValue":t[19]||(t[19]=l=>a.value.unit_of_measurement=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,a.value.unit_of_measurement]])]),e("div",null,[We,n(e("select",{"onUpdate:modelValue":t[20]||(t[20]=l=>a.value.sold_by=l),class:"w-full border p-2 rounded"},Qe,512),[[b,a.value.sold_by]])]),e("div",ze,[Ke,n(e("input",{"onUpdate:modelValue":t[21]||(t[21]=l=>a.value.image=l),type:"text",class:"w-full border p-2 rounded"},null,512),[[d,a.value.image]])]),e("div",null,[Re,n(e("select",{"onUpdate:modelValue":t[22]||(t[22]=l=>a.value.warehouse_id=l),class:"w-full border p-2 rounded"},[(u(!0),r(p,null,f(c(v).warehouses,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,Ye))),128))],512),[[b,a.value.warehouse_id]])]),e("div",null,[Ge,n(e("select",{"onUpdate:modelValue":t[23]||(t[23]=l=>a.value.category_id=l),class:"w-full border p-2 rounded",onChange:t[24]||(t[24]=l=>V(a.value.category_id))},[(u(!0),r(p,null,f(c(m).items.data,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,He))),128))],544),[[b,a.value.category_id]])]),e("div",Je,[Oe,n(e("select",{"onUpdate:modelValue":t[25]||(t[25]=l=>a.value.subcategory_id=l),class:"w-full border p-2 rounded"},[(u(!0),r(p,null,f(c(m).subcategories,l=>(u(),r("option",{key:l.id,value:l.id},_(l.name),9,Xe))),128))],512),[[b,a.value.subcategory_id]])])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:F},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:A},"Update")])])])):C("",!0)],64))}};export{wl as default};
