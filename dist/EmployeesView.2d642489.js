import{aa as G,a as y,s as S,b as n,c as U,e as h,f as g,h as d,v as H,t as w,m as f,i as e,l as r,B as u,C as c,L as E,F as P,x as C,S as V}from"./index.a2c9f28c.js";import{_ as K}from"./LayoutAuthenticatedX.d58fd7d8.js";import{_ as O}from"./SectionMain.8435c1f0.js";import{u as X}from"./employeeStore.497070e0.js";import{u as Z}from"./departmentStore.c7e56a4b.js";import{u as ee}from"./jobTitleStore.f359ffbf.js";import{_ as te}from"./NotificationBar.caa84e93.js";import{B as le}from"./BaseTable.a063d648.js";import{_ as ae}from"./CardBox.25a3dc7a.js";import{_ as oe}from"./SectionTitleLineWithButton.39476921.js";import{_ as N}from"./BaseButton.b8e12a74.js";import{p as se,c as ie,u as ne,v as re}from"./mdi.aa269c9f.js";import"./darkMode.b88882a1.js";import"./BaseIcon.ad3a4017.js";import"./FormControl.2759acc3.js";import"./FooterBar.948c11c8.js";import"./logo.c6f18b48.js";import"./BaseLevel.e0eed931.js";import"./index.0363223d.js";import"./TableCheckboxCell.8ab5003b.js";import"./BaseButtons.e7208c74.js";import"./_plugin-vue_export-helper.c27b6911.js";const ue={class:"flex items-center gap-2"},de={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},ce={class:"bg-white p-6 rounded shadow-lg w-[600px]"},me=e("h2",{class:"text-xl mb-4"},"Add Employee",-1),pe={class:"grid grid-cols-2 gap-4"},_e=e("label",{class:"block mb-1"},"First Name",-1),fe=e("label",{class:"block mb-1"},"Last Name",-1),be={class:"col-span-2"},ve=e("label",{class:"block mb-1"},"Email",-1),ye=e("label",{class:"block mb-1"},"Phone",-1),he=e("label",{class:"block mb-1"},"Department",-1),ge=["value"],we=e("label",{class:"block mb-1"},"Job Title",-1),ke=["value"],xe={class:"col-span-2"},Ee=e("label",{class:"block mb-1"},"Picture",-1),Pe=["src"],Ce={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},Ue={class:"bg-white p-6 rounded shadow-lg w-[600px]"},Le=e("h2",{class:"text-xl mb-4"},"Edit Employee",-1),Se={class:"grid grid-cols-2 gap-4"},Ve=e("label",{class:"block mb-1"},"First Name",-1),Ne=e("label",{class:"block mb-1"},"Last Name",-1),De={class:"col-span-2"},je=e("label",{class:"block mb-1"},"Email",-1),Be=e("label",{class:"block mb-1"},"Phone",-1),Ie=e("label",{class:"block mb-1"},"Department",-1),Fe=["value"],Te=e("label",{class:"block mb-1"},"Job Title",-1),$e=["value"],Ae={class:"col-span-2"},Me=e("label",{class:"block mb-1"},"Picture",-1),Re=["src"],ct={__name:"EmployeesView",setup(Je){const{appContext:D}=G(),j=D.config.globalProperties.API_URL||"",k=y(!1),x=y(!1),i=y({first_name:"",last_name:"",email:"",phone:"",department_id:null,job_title_id:null,status:"active",picture:""}),o=y({id:null,first_name:"",last_name:"",email:"",phone:"",department_id:null,job_title_id:null,status:"active",picture:""}),B=S(()=>o.value.picture?o.value.picture.startsWith("data:")?o.value.picture:`${j}${o.value.picture}`:""),s=X(),m=Z(),p=ee(),b=y([]);async function v(a={},l=!1){await s.fetchItems(a,l)}v({page:1,limit:5});const I=S(()=>{var a,l,t,_,L;return{total:((a=s.items)==null?void 0:a.total)||0,totalPages:((l=s.items)==null?void 0:l.totalPages)||1,currentPage:((t=s.items)==null?void 0:t.currentPage)||1,pageSize:((_=s.items)==null?void 0:_.pageSize)||5,data:((L=s.items)==null?void 0:L.data)||[]}}),F=[{key:"first_name",label:"First Name",sortable:!0,filterable:!0},{key:"last_name",label:"Last Name",sortable:!0,filterable:!0},{key:"email",label:"Email",sortable:!0,filterable:!0},{key:"phone",label:"Phone",sortable:!0,filterable:!0}],T=async a=>{await v(a,!0)},$=a=>{b.value=a},A=async a=>{for(s.isLoading=!0,await Promise.all([m.fetchItems(),p.fetchItems()]);m.isLoading||p.isLoading;)await new Promise(l=>setTimeout(l,100));o.value={id:a.id,first_name:a.first_name,last_name:a.last_name,email:a.email,phone:a.phone,department_id:a.department_id,job_title_id:a.job_title_id,status:a.status,picture:a.picture||""},x.value=!0,s.isLoading=!1},M=async()=>{for(s.isLoading=!0,await Promise.all([m.fetchItems(),p.fetchItems()]);m.isLoading||p.isLoading;)await new Promise(a=>setTimeout(a,100));i.value={first_name:"",last_name:"",email:"",phone:"",department_id:null,job_title_id:null,status:"active",picture:""},k.value=!0,s.isLoading=!1};async function R(){await s.createItem(i.value),s.error||(k.value=!1,await v({page:1,limit:5},!0))}async function J(){await s.updateItem(o.value.id,o.value),s.error||(x.value=!1,await v({page:1,limit:5},!0))}async function z(){if(b.value.length===0)return;if((await V.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete them!"})).isConfirmed){for(const l of b.value)if(await s.deleteItem(l),s.error)break;s.error||(b.value=[],await v({page:1,limit:5},!0),V.fire("Deleted!","The employees have been deleted.","success"))}}function Q(a){const l=a.target.files[0];if(!l)return;const t=new FileReader;t.onload=_=>{i.value.picture=_.target.result},t.readAsDataURL(l)}function W(a){const l=a.target.files[0];if(!l)return;const t=new FileReader;t.onload=_=>{o.value.picture=_.target.result},t.readAsDataURL(l)}const Y=()=>{k.value=!1},q=()=>{x.value=!1};return(a,l)=>(n(),U(K,null,{default:h(()=>[g(O,null,{default:h(()=>[d(s).error?(n(),U(te,{key:0,icon:d(se),color:"danger"},{default:h(()=>[H(w(d(s).error),1)]),_:1},8,["icon"])):f("",!0),g(oe,{icon:d(ie),title:"Employees",main:""},{default:h(()=>[e("div",ue,[g(N,{icon:d(ne),color:"primary",label:"New Employee",onClick:M},null,8,["icon"]),b.value.length?(n(),U(N,{key:0,icon:d(re),color:"danger",label:"Delete",onClick:z},null,8,["icon"])):f("",!0)])]),_:1},8,["icon"]),g(ae,{class:"mb-6"},{default:h(()=>[g(le,{columns:F,data:I.value,loading:d(s).isLoading,checkable:"",onQueryChange:T,onSelected:$,onEdit:A},null,8,["data","loading"])]),_:1})]),_:1}),k.value?(n(),r("div",de,[e("div",ce,[me,e("div",pe,[e("div",null,[_e,u(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>i.value.first_name=t),type:"text",class:"w-full border p-2 rounded"},null,512),[[c,i.value.first_name]])]),e("div",null,[fe,u(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>i.value.last_name=t),type:"text",class:"w-full border p-2 rounded"},null,512),[[c,i.value.last_name]])]),e("div",be,[ve,u(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>i.value.email=t),type:"email",class:"w-full border p-2 rounded"},null,512),[[c,i.value.email]])]),e("div",null,[ye,u(e("input",{"onUpdate:modelValue":l[3]||(l[3]=t=>i.value.phone=t),type:"tel",class:"w-full border p-2 rounded"},null,512),[[c,i.value.phone]])]),e("div",null,[he,u(e("select",{"onUpdate:modelValue":l[4]||(l[4]=t=>i.value.department_id=t),class:"w-full border p-2 rounded"},[(n(!0),r(P,null,C(d(m).items.data,t=>(n(),r("option",{key:t.id,value:t.id},w(t.name),9,ge))),128))],512),[[E,i.value.department_id]])]),e("div",null,[we,u(e("select",{"onUpdate:modelValue":l[5]||(l[5]=t=>i.value.job_title_id=t),class:"w-full border p-2 rounded"},[(n(!0),r(P,null,C(d(p).items.data,t=>(n(),r("option",{key:t.id,value:t.id},w(t.title),9,ke))),128))],512),[[E,i.value.job_title_id]])]),e("div",xe,[Ee,e("input",{type:"file",accept:"image/*",onChange:Q,class:"w-full border p-2 rounded"},null,32),i.value.picture?(n(),r("img",{key:0,src:i.value.picture,alt:"Picture Preview",class:"mt-2 h-32 object-contain"},null,8,Pe)):f("",!0)])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:Y}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:R}," Save ")])])])):f("",!0),x.value?(n(),r("div",Ce,[e("div",Ue,[Le,e("div",Se,[e("div",null,[Ve,u(e("input",{"onUpdate:modelValue":l[6]||(l[6]=t=>o.value.first_name=t),type:"text",class:"w-full border p-2 rounded"},null,512),[[c,o.value.first_name]])]),e("div",null,[Ne,u(e("input",{"onUpdate:modelValue":l[7]||(l[7]=t=>o.value.last_name=t),type:"text",class:"w-full border p-2 rounded"},null,512),[[c,o.value.last_name]])]),e("div",De,[je,u(e("input",{"onUpdate:modelValue":l[8]||(l[8]=t=>o.value.email=t),type:"email",class:"w-full border p-2 rounded"},null,512),[[c,o.value.email]])]),e("div",null,[Be,u(e("input",{"onUpdate:modelValue":l[9]||(l[9]=t=>o.value.phone=t),type:"tel",class:"w-full border p-2 rounded"},null,512),[[c,o.value.phone]])]),e("div",null,[Ie,u(e("select",{"onUpdate:modelValue":l[10]||(l[10]=t=>o.value.department_id=t),class:"w-full border p-2 rounded"},[(n(!0),r(P,null,C(d(m).items.data,t=>(n(),r("option",{key:t.id,value:t.id},w(t.name),9,Fe))),128))],512),[[E,o.value.department_id]])]),e("div",null,[Te,u(e("select",{"onUpdate:modelValue":l[11]||(l[11]=t=>o.value.job_title_id=t),class:"w-full border p-2 rounded"},[(n(!0),r(P,null,C(d(p).items.data,t=>(n(),r("option",{key:t.id,value:t.id},w(t.title),9,$e))),128))],512),[[E,o.value.job_title_id]])]),e("div",Ae,[Me,e("input",{type:"file",accept:"image/*",onChange:W,class:"w-full border p-2 rounded"},null,32),o.value.picture?(n(),r("img",{key:0,src:B.value,alt:"Picture Preview",class:"mt-2 w-32 h-32 object-contain"},null,8,Re)):f("",!0)])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:q}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:J}," Update ")])])])):f("",!0)]),_:1}))}};export{ct as default};
