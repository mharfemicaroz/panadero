import{aa as j,a as b,s as F,b as i,c as A,e as v,f,h as d,v as O,t as h,m as w,i as e,l as c,B as r,L as x,F as V,x as U,C as u,S as D}from"./index.fa4aaca0.js";import{_ as z}from"./LayoutAuthenticatedX.903f0881.js";import{_ as Q}from"./SectionMain.65752272.js";import{_ as Y}from"./NotificationBar.2dd16147.js";import{B as q}from"./BaseTable.3881ec66.js";import{_ as G}from"./CardBox.a1184ae0.js";import{_ as J}from"./SectionTitleLineWithButton.8dc98713.js";import{_ as B}from"./BaseButton.7542bf1a.js";import{p as K,c as W,u as X,v as Z}from"./mdi.50c7bbe5.js";import{u as ee}from"./attendanceStore.d4a8f0b6.js";import{u as te}from"./employeeStore.b279dfac.js";import"./darkMode.dc7262dc.js";import"./BaseIcon.4caf67cb.js";import"./FormControl.1d43ffa3.js";import"./FooterBar.843fa662.js";import"./logo.c6f18b48.js";import"./BaseLevel.511e0059.js";import"./TableCheckboxCell.5507bf42.js";import"./BaseButtons.446b06e3.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./index.73340c3e.js";const ae={class:"flex items-center gap-2"},le={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},se={class:"bg-white p-6 rounded shadow-lg w-[600px]"},oe=e("h2",{class:"text-xl mb-4"},"Add Attendance Record",-1),ne={class:"grid grid-cols-2 gap-4"},re={class:"col-span-2"},ie=e("label",{class:"block mb-1"},"Employee",-1),de=e("option",{value:"",disabled:""},"Select Employee",-1),ue=["value"],ce={class:"col-span-2"},me=e("label",{class:"block mb-1"},"Date",-1),pe=e("label",{class:"block mb-1"},"Status",-1),_e=e("option",{value:"present"},"Present",-1),be=e("option",{value:"absent"},"Absent",-1),ve=e("option",{value:"late"},"Late",-1),fe=e("option",{value:"half_day"},"Half Day",-1),he=[_e,be,ve,fe],ye=e("label",{class:"block mb-1"},"Total Hours",-1),ge=e("label",{class:"block mb-1"},"Overtime Hours",-1),ke={class:"col-span-2"},we=e("label",{class:"block mb-1"},"Remarks",-1),xe={class:"flex justify-end space-x-2 mt-4"},Ae={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},Ce={class:"bg-white p-6 rounded shadow-lg w-[600px]"},Se=e("h2",{class:"text-xl mb-4"},"Edit Attendance Record",-1),Ve={class:"grid grid-cols-2 gap-4"},Ue={class:"col-span-2"},De=e("label",{class:"block mb-1"},"Employee",-1),Be=e("option",{value:"",disabled:""},"Select Employee",-1),Ee=["value"],Le={class:"col-span-2"},Te=e("label",{class:"block mb-1"},"Date",-1),$e=e("label",{class:"block mb-1"},"Status",-1),Ie=e("option",{value:"present"},"Present",-1),Pe=e("option",{value:"absent"},"Absent",-1),He=e("option",{value:"late"},"Late",-1),Ne=e("option",{value:"half_day"},"Half Day",-1),Re=[Ie,Pe,He,Ne],Me=e("label",{class:"block mb-1"},"Total Hours",-1),je=e("label",{class:"block mb-1"},"Overtime Hours",-1),Fe={class:"col-span-2"},Oe=e("label",{class:"block mb-1"},"Remarks",-1),ze={class:"flex justify-end space-x-2 mt-4"},pt={__name:"AttendanceView",setup(Qe){const{appContext:E}=j();E.config.globalProperties.API_URL;const y=b(!1),g=b(!1),n=b({employee_id:null,date:"",status:"present",total_hours:0,overtime_hours:0,remarks:""}),o=b({id:null,employee_id:null,date:"",status:"present",total_hours:0,overtime_hours:0,remarks:""}),l=ee(),k=te(),m=b([]);async function p(s={},a=!1){await l.fetchItems(s,a)}p({page:1,limit:10});const L=F(()=>{var s,a,t,C,S;return{total:((s=l.items)==null?void 0:s.total)||0,totalPages:((a=l.items)==null?void 0:a.totalPages)||1,currentPage:((t=l.items)==null?void 0:t.currentPage)||1,pageSize:((C=l.items)==null?void 0:C.pageSize)||10,data:(((S=l.items)==null?void 0:S.data)||[]).map(_=>({..._,employee_name:_.employee?`${_.employee.first_name} ${_.employee.last_name}`:_.employee_id}))}}),T=[{key:"employee_name",label:"Employee",sortable:!1,filterable:!1},{key:"date",label:"Date",sortable:!0,filterable:!0},{key:"status",label:"Status",sortable:!0,filterable:!0},{key:"total_hours",label:"Total Hours",sortable:!0,filterable:!0},{key:"overtime_hours",label:"Overtime Hours",sortable:!0,filterable:!0},{key:"remarks",label:"Remarks",sortable:!1,filterable:!1}],$=async s=>{await p(s,!0)},I=s=>{m.value=s},P=async s=>{l.isLoading=!0,await k.fetchItems({page:1,limit:100},!0),o.value={id:s.id,employee_id:s.employee_id,date:s.date,status:s.status,total_hours:s.total_hours,overtime_hours:s.overtime_hours,remarks:s.remarks},g.value=!0,l.isLoading=!1},H=async()=>{l.isLoading=!0,await k.fetchItems({page:1,limit:100},!0),n.value={employee_id:null,date:"",status:"present",total_hours:0,overtime_hours:0,remarks:""},y.value=!0,l.isLoading=!1};async function N(){await l.createItem(n.value),l.error||(y.value=!1,await p({page:1,limit:10},!0))}async function R(){await l.updateItem(o.value.id,o.value),l.error||(g.value=!1,await p({page:1,limit:10},!0))}async function M(){if(m.value.length===0)return;if((await D.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete them!"})).isConfirmed){for(const a of m.value)if(await l.deleteItem(a),l.error)break;l.error||(m.value=[],await p({page:1,limit:10},!0),D.fire("Deleted!","The attendance records have been deleted.","success"))}}return(s,a)=>(i(),A(z,null,{default:v(()=>[f(Q,null,{default:v(()=>[d(l).error?(i(),A(Y,{key:0,icon:d(K),color:"danger"},{default:v(()=>[O(h(d(l).error),1)]),_:1},8,["icon"])):w("",!0),f(J,{icon:d(W),title:"Attendance Records",main:""},{default:v(()=>[e("div",ae,[f(B,{icon:d(X),color:"primary",label:"New Attendance",onClick:H},null,8,["icon"]),m.value.length?(i(),A(B,{key:0,icon:d(Z),color:"danger",label:"Delete",onClick:M},null,8,["icon"])):w("",!0)])]),_:1},8,["icon"]),f(G,{class:"mb-6"},{default:v(()=>[f(q,{columns:T,data:L.value,loading:d(l).isLoading,checkable:"",onQueryChange:$,onSelected:I,onEdit:P},null,8,["data","loading"])]),_:1})]),_:1}),y.value?(i(),c("div",le,[e("div",se,[oe,e("div",ne,[e("div",re,[ie,r(e("select",{"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.employee_id=t),class:"w-full border p-2 rounded"},[de,(i(!0),c(V,null,U(d(k).items.data,t=>(i(),c("option",{key:t.id,value:t.id},h(t.first_name)+" "+h(t.last_name),9,ue))),128))],512),[[x,n.value.employee_id]])]),e("div",ce,[me,r(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.date=t),type:"date",class:"w-full border p-2 rounded"},null,512),[[u,n.value.date]])]),e("div",null,[pe,r(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>n.value.status=t),class:"w-full border p-2 rounded"},he,512),[[x,n.value.status]])]),e("div",null,[ye,r(e("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>n.value.total_hours=t),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[u,n.value.total_hours,void 0,{number:!0}]])]),e("div",null,[ge,r(e("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>n.value.overtime_hours=t),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[u,n.value.overtime_hours,void 0,{number:!0}]])]),e("div",ke,[we,r(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=t=>n.value.remarks=t),class:"w-full border p-2 rounded"},null,512),[[u,n.value.remarks]])])]),e("div",xe,[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:a[6]||(a[6]=t=>y.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:N}," Save ")])])])):w("",!0),g.value?(i(),c("div",Ae,[e("div",Ce,[Se,e("div",Ve,[e("div",Ue,[De,r(e("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>o.value.employee_id=t),class:"w-full border p-2 rounded"},[Be,(i(!0),c(V,null,U(d(k).items.data,t=>(i(),c("option",{key:t.id,value:t.id},h(t.first_name)+" "+h(t.last_name),9,Ee))),128))],512),[[x,o.value.employee_id]])]),e("div",Le,[Te,r(e("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>o.value.date=t),type:"date",class:"w-full border p-2 rounded"},null,512),[[u,o.value.date]])]),e("div",null,[$e,r(e("select",{"onUpdate:modelValue":a[9]||(a[9]=t=>o.value.status=t),class:"w-full border p-2 rounded"},Re,512),[[x,o.value.status]])]),e("div",null,[Me,r(e("input",{"onUpdate:modelValue":a[10]||(a[10]=t=>o.value.total_hours=t),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[u,o.value.total_hours,void 0,{number:!0}]])]),e("div",null,[je,r(e("input",{"onUpdate:modelValue":a[11]||(a[11]=t=>o.value.overtime_hours=t),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[u,o.value.overtime_hours,void 0,{number:!0}]])]),e("div",Fe,[Oe,r(e("textarea",{"onUpdate:modelValue":a[12]||(a[12]=t=>o.value.remarks=t),class:"w-full border p-2 rounded"},null,512),[[u,o.value.remarks]])])]),e("div",ze,[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:a[13]||(a[13]=t=>g.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:R}," Update ")])])])):w("",!0)]),_:1}))}};export{pt as default};
