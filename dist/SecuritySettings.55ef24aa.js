import{u as F,a as n,p as S,b as v,c as k,e as s,f as t,h as i,l as p,t as h,m as g,i as a}from"./index.c3b8df4f.js";import{c as C,d as E,e as $,f as B,b as D,g as N}from"./mdi.aa269c9f.js";import{_ as T}from"./LayoutAuthenticatedX.b8bb81e8.js";import{_ as q}from"./SectionMain.13d65fb7.js";import{_ as L}from"./SectionTitleLineWithButton.e58ee057.js";import{_ as x}from"./CardBox.b2ca2ff4.js";import{_ as m}from"./BaseButton.db2641b8.js";import{_ as b}from"./FormField.8bb16c87.js";import"./darkMode.be9f2000.js";import"./BaseIcon.7a5ae775.js";import"./FormControl.f0dd7a4c.js";import"./FooterBar.9f5e8a1a.js";import"./logo.c6f18b48.js";import"./BaseLevel.3eae5b81.js";import"./_plugin-vue_export-helper.c27b6911.js";const M=a("h2",{class:"text-center text-lg font-bold mb-4"},"Two-Factor Authentication",-1),O={key:0,class:"text-red-500 text-sm text-center mb-3"},R={class:"flex flex-col items-center space-y-4"},V={key:0,class:"flex flex-col items-center text-center w-full max-w-sm mx-auto"},G=a("h3",{class:"font-bold text-lg mt-4"},"Scan QR Code with Google Authenticator",-1),Q={class:"flex justify-center mt-2"},j=["src"],I=a("p",{class:"text-sm mt-3"},"Or enter this secret manually:",-1),K={class:"text-lg font-mono bg-gray-200 p-3 rounded w-full break-all"},z=a("h2",{class:"text-lg font-bold mb-4"},"Additional Security Settings",-1),re={__name:"SecuritySettings",setup(H){const c=F(),f=n(null),d=n(null),_=n(null),r=n(!1),o=n(""),l=n(!1),y=()=>{var e,u;l.value=((e=c.user)==null?void 0:e.twoFAEnabled)||!1,f.value=((u=c.user)==null?void 0:u.id)||null};S(()=>{var e;l.value=((e=c.user)==null?void 0:e.twoFAEnabled)||!1});const A=async()=>{try{r.value=!0,o.value="";const e=await c.enable2FA(f.value);d.value=e.qrCode,_.value=e.secret,l.value=!0}catch(e){o.value=e.message}finally{r.value=!1}},w=async()=>{try{r.value=!0,o.value="",await c.disable2FA(f.value),d.value=null,_.value=null,l.value=!1}catch(e){o.value=e.message}finally{r.value=!1}};return y(),(e,u)=>(v(),k(T,null,{default:s(()=>[t(q,null,{default:s(()=>[t(L,{icon:i(C),title:"Security Settings",main:""},null,8,["icon"]),t(x,{class:"mb-6"},{default:s(()=>[M,o.value?(v(),p("p",O,h(o.value),1)):g("",!0),a("div",R,[t(m,{disabled:r.value,icon:l.value?i(E):i($),color:l.value?"warning":"info",label:l.value?"Disable 2FA":"Enable 2FA",onClick:u[0]||(u[0]=J=>l.value?w():A())},null,8,["disabled","icon","color","label"]),d.value?(v(),p("div",V,[G,a("div",Q,[a("img",{src:d.value,alt:"2FA QR Code",class:"w-48 h-48 sm:w-56 sm:h-56 md:w-64 md:h-64 border rounded-md p-2 shadow-lg"},null,8,j)]),I,a("p",K,h(_.value),1)])):g("",!0)])]),_:1}),t(x,{class:"mb-6"},{default:s(()=>[z,t(b,{label:"Email Notifications for Login Attempts"},{default:s(()=>[t(m,{icon:i(B),color:"info",label:"Manage Email Alerts",disabled:""},null,8,["icon"])]),_:1}),t(b,{label:"Recovery Codes"},{default:s(()=>[t(m,{icon:i(D),color:"info",label:"Generate Backup Codes",disabled:""},null,8,["icon"])]),_:1}),t(b,{label:"Trusted Devices"},{default:s(()=>[t(m,{icon:i(N),color:"info",label:"Manage Trusted Devices",disabled:""},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{re as default};
