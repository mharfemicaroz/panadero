import{a as p,s as I,b as f,l as w,f as d,e as b,i as e,B as n,C as i,m as g,F as z,h as u,c as k,v as Q,t as Y,S as C}from"./index.a2c9f28c.js";import{p as q,c as G,u as H,v as J}from"./mdi.aa269c9f.js";import{_ as K}from"./SectionMain.8435c1f0.js";import{_ as O}from"./NotificationBar.caa84e93.js";import{B as R}from"./BaseTable.a063d648.js";import{_ as W}from"./CardBox.25a3dc7a.js";import{_ as X}from"./LayoutAuthenticatedX.d58fd7d8.js";import{_ as Z}from"./SectionTitleLineWithButton.39476921.js";import{_ as N}from"./BaseButton.b8e12a74.js";import{u as ee}from"./user.622b5b9d.js";import"./FooterBar.948c11c8.js";import"./BaseIcon.ad3a4017.js";import"./FormControl.2759acc3.js";import"./logo.c6f18b48.js";import"./BaseLevel.e0eed931.js";import"./TableCheckboxCell.8ab5003b.js";import"./BaseButtons.e7208c74.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./darkMode.b88882a1.js";const le={class:"flex items-center gap-2"},ae={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},te={class:"bg-white p-6 rounded shadow-lg w-[600px]"},se=e("h2",{class:"text-xl mb-4"},"Add User",-1),oe={class:"grid grid-cols-2 gap-4"},re=e("label",{class:"block mb-1"},"Username",-1),ne=e("label",{class:"block mb-1"},"Email",-1),ie=e("label",{class:"block mb-1"},"Password",-1),ue=e("label",{class:"block mb-1"},"First Name",-1),de=e("label",{class:"block mb-1"},"Last Name",-1),me={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},ce={class:"bg-white p-6 rounded shadow-lg w-[600px]"},pe=e("h2",{class:"text-xl mb-4"},"Edit User",-1),fe={class:"grid grid-cols-2 gap-4"},be=e("label",{class:"block mb-1"},"Username",-1),_e=e("label",{class:"block mb-1"},"Email",-1),ve=e("label",{class:"block mb-1"},"First Name",-1),ge=e("label",{class:"block mb-1"},"Last Name",-1),Le={__name:"UserManagementView",setup(we){const _=p(!1),v=p(!1),o=p({username:"",email:"",password:"",role:"user",first_name:"",last_name:""}),r=p({id:null,username:"",email:"",role:"user",first_name:"",last_name:""}),s=ee(),m=p([]);async function c(t={},l=!1){await s.fetchAll(t,l)}c({page:1,limit:10});const B=I(()=>{var x,h,U;const t=((x=s.users)==null?void 0:x.pageSize)||10,a=(((h=s.users)==null?void 0:h.data)||[]).filter(L=>L.role==="user"),y=a.length,A=Math.ceil(y/t);return{total:y,totalPages:A,currentPage:((U=s.users)==null?void 0:U.currentPage)||1,pageSize:t,data:a}}),V=[{key:"username",label:"Username",sortable:!0,filterable:!0},{key:"email",label:"Email",sortable:!0,filterable:!0},{key:"first_name",label:"First Name",sortable:!0,filterable:!0},{key:"last_name",label:"Last Name",sortable:!0,filterable:!0}],S=async t=>{await c(t,!0)},D=t=>{m.value=t},E=async t=>{r.value={id:t.id,username:t.username,email:t.email,role:"user",first_name:t.first_name,last_name:t.last_name},v.value=!0},M=()=>{o.value={username:"",email:"",password:"",role:"user",first_name:"",last_name:""},_.value=!0};async function F(){await s.create(o.value),s.error||(_.value=!1,await c({page:1,limit:10},!0))}async function T(){await s.updateById(r.value.id,r.value),s.error||(v.value=!1,await c({page:1,limit:10},!0))}async function $(){if(m.value.length===0)return;if((await C.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete them!"})).isConfirmed){for(const l of m.value)if(await s.deleteById(l),s.error)break;s.error||(m.value=[],await c({page:1,limit:10},!0),C.fire("Deleted!","The users have been deleted.","success"))}}const P=()=>{_.value=!1},j=()=>{v.value=!1};return(t,l)=>(f(),w(z,null,[d(X,null,{default:b(()=>[d(K,null,{default:b(()=>[u(s).error?(f(),k(O,{key:0,icon:u(q),color:"danger"},{default:b(()=>[Q(Y(u(s).error),1)]),_:1},8,["icon"])):g("",!0),d(Z,{icon:u(G),title:"Users",main:""},{default:b(()=>[e("div",le,[d(N,{icon:u(H),color:"primary",label:"New User",onClick:M},null,8,["icon"]),m.value.length?(f(),k(N,{key:0,icon:u(J),color:"danger",label:"Delete",onClick:$},null,8,["icon"])):g("",!0)])]),_:1},8,["icon"]),d(W,{class:"mb-6"},{default:b(()=>[d(R,{columns:V,data:B.value,loading:u(s).isLoading,checkable:"",onQueryChange:S,onSelected:D,onEdit:E},null,8,["data","loading"])]),_:1})]),_:1})]),_:1}),_.value?(f(),w("div",ae,[e("div",te,[se,e("div",oe,[e("div",null,[re,n(e("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.username=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,o.value.username]])]),e("div",null,[ne,n(e("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.email=a),type:"email",class:"w-full border p-2 rounded"},null,512),[[i,o.value.email]])]),e("div",null,[ie,n(e("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.password=a),type:"password",class:"w-full border p-2 rounded"},null,512),[[i,o.value.password]])]),e("div",null,[ue,n(e("input",{"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.first_name=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,o.value.first_name]])]),e("div",null,[de,n(e("input",{"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.last_name=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,o.value.last_name]])])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:P},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:F},"Save")])])])):g("",!0),v.value?(f(),w("div",me,[e("div",ce,[pe,e("div",fe,[e("div",null,[be,n(e("input",{"onUpdate:modelValue":l[5]||(l[5]=a=>r.value.username=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,r.value.username]])]),e("div",null,[_e,n(e("input",{"onUpdate:modelValue":l[6]||(l[6]=a=>r.value.email=a),type:"email",class:"w-full border p-2 rounded"},null,512),[[i,r.value.email]])]),e("div",null,[ve,n(e("input",{"onUpdate:modelValue":l[7]||(l[7]=a=>r.value.first_name=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,r.value.first_name]])]),e("div",null,[ge,n(e("input",{"onUpdate:modelValue":l[8]||(l[8]=a=>r.value.last_name=a),type:"text",class:"w-full border p-2 rounded"},null,512),[[i,r.value.last_name]])])]),e("div",{class:"flex justify-end space-x-2 mt-4"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:j},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:T},"Update")])])])):g("",!0)],64))}};export{Le as default};
