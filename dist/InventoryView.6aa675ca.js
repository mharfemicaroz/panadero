import{a as p,s as M,b as v,l as g,f as r,e as d,i as t,t as h,B as u,M as U,C as c,m as q,F as $,h as s,c as j,v as N}from"./index.81ed66ed.js";import{_ as P}from"./LayoutAuthenticatedX.a0217d4b.js";import{_ as T}from"./SectionMain.ff7c0a76.js";import{u as A}from"./inventory.640e3860.js";import{_ as D}from"./NotificationBar.62c87214.js";import{B as F}from"./BaseTable.aa93a529.js";import{_ as z}from"./CardBox.d4dece43.js";import{_ as L}from"./SectionTitleLineWithButton.9b4305a6.js";import{_ as x}from"./BaseButton.4cf3599a.js";import{p as R,c as W,B as G,i as H}from"./mdi.aa269c9f.js";import"./darkMode.4d354904.js";import"./BaseIcon.f7bbc3f6.js";import"./FormControl.7fdae42f.js";import"./FooterBar.223d3b14.js";import"./logo.c6f18b48.js";import"./BaseLevel.f8579f88.js";import"./index.8f8d0999.js";import"./TableCheckboxCell.5bd18b8c.js";import"./BaseButtons.e89c9a47.js";import"./_plugin-vue_export-helper.c27b6911.js";const J={class:"flex items-center gap-2"},K={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},O={class:"bg-white p-6 rounded shadow-lg w-96"},X=t("h2",{class:"text-xl mb-4"},"Update Inventory",-1),Y=t("label",{class:"block mb-1"},"Warehouse",-1),Z={class:"p-2 bg-gray-100 rounded"},ee=t("label",{class:"block mt-2 mb-1"},"Item",-1),te={class:"p-2 bg-gray-100 rounded"},ae={class:"flex items-center mt-4 mb-2"},ne=t("label",null,"Auto-Compute (Stock Adjustment Mode)",-1),oe={class:"grid grid-cols-2 gap-2"},le=t("label",{class:"block mb-1"},"Current Quantity",-1),ie=["disabled"],re={key:0},se=t("label",{class:"block mb-1"},"Quantity Change",-1),ue={class:"grid grid-cols-2 gap-2 mt-4"},me=t("label",{class:"block mb-1"},"Minimum Quantity",-1),de=t("label",{class:"block mb-1"},"Maximum Quantity",-1),ce=t("label",{class:"block mt-2 mb-1"},"Reorder Level",-1),$e={__name:"InventoryView",setup(ye){const y=p(!1),i=p(!1),l=p({id:null,warehouse:"",item:"",current_quantity:0,minimum_quantity:0,maximum_quantity:0,reorder_level:0,quantityChange:0}),o=A(),k=p([]);async function b(a={},e=!1){await o.fetchItems(a,e)}b({page:1,limit:5});const C=M(()=>{var a,e,n,m,_;return{total:((a=o.items)==null?void 0:a.total)||0,totalPages:((e=o.items)==null?void 0:e.totalPages)||1,currentPage:((n=o.items)==null?void 0:n.currentPage)||1,pageSize:((m=o.items)==null?void 0:m.pageSize)||5,data:((_=o.items)==null?void 0:_.data)||[]}}),I=[{key:"item",label:"Item",formatter:(a,e)=>e.item?e.item.name:""},{key:"category",label:"Category",formatter:(a,e)=>{var n;return(n=e.item)!=null&&n.category?e.item.category.name:""}},{key:"subcategory",label:"Subcategory",formatter:(a,e)=>{var n;return(n=e.item)!=null&&n.subcategory?e.item.subcategory.name:""}},{key:"current_quantity",label:"Current Quantity",sortable:!0}],w=async a=>{await b(a,!0)},S=a=>{k.value=a},V=async a=>{l.value={id:a.id,warehouse:a.warehouse?a.warehouse.name:"",item:a.item?a.item.name:"",current_quantity:a.current_quantity,minimum_quantity:a.minimum_quantity,maximum_quantity:a.maximum_quantity,reorder_level:a.reorder_level,quantityChange:0},i.value=!1,y.value=!0};async function B(){var a;try{const e=l.value,{id:n,quantityChange:m}=e;i.value&&(e.current_quantity+=m),await o.fetchItemById(n);const _=((a=o.item)==null?void 0:a.current_quantity)||0,f=i.value?m:e.current_quantity-_,Q=f>0?"manual add":f<0?"manual deduct":"";if(await o.adjustItemQuantity(n,f,Q),o.error)throw new Error(o.error);await o.updateItem(n,{minimum_quantity:e.minimum_quantity,maximum_quantity:e.maximum_quantity,reorder_level:e.reorder_level}),await b({page:1,limit:5},!0)}catch(e){console.error("Error updating inventory:",e)}finally{y.value=!1}}const E=()=>{y.value=!1};return(a,e)=>(v(),g($,null,[r(P,null,{default:d(()=>[r(T,null,{default:d(()=>[s(o).error?(v(),j(D,{key:0,icon:s(R),color:"danger"},{default:d(()=>[N(h(s(o).error),1)]),_:1},8,["icon"])):q("",!0),r(L,{icon:s(W),title:"Inventory",main:""},{default:d(()=>[t("div",J,[r(x,{icon:s(G),color:"success",label:"Import Stocks"},null,8,["icon"]),r(x,{icon:s(H),color:"warning",label:"Export Stocks"},null,8,["icon"])])]),_:1},8,["icon"]),r(z,{class:"mb-6"},{default:d(()=>[r(F,{columns:I,data:C.value,loading:s(o).isLoading,onQueryChange:w,onSelected:S,onEdit:V},null,8,["data","loading"])]),_:1})]),_:1})]),_:1}),y.value?(v(),g("div",K,[t("div",O,[X,Y,t("p",Z,h(l.value.warehouse),1),ee,t("p",te,h(l.value.item),1),t("div",ae,[u(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=n=>i.value=n),class:"mr-2"},null,512),[[U,i.value]]),ne]),t("div",oe,[t("div",null,[le,u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.current_quantity=n),disabled:i.value,type:"number",class:"w-full border p-2 rounded"},null,8,ie),[[c,l.value.current_quantity]])]),i.value?(v(),g("div",re,[se,u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.quantityChange=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[c,l.value.quantityChange]])])):q("",!0)]),t("div",ue,[t("div",null,[me,u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.minimum_quantity=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[c,l.value.minimum_quantity]])]),t("div",null,[de,u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.maximum_quantity=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[c,l.value.maximum_quantity]])])]),ce,u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.reorder_level=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[c,l.value.reorder_level]]),t("div",{class:"flex justify-end space-x-2 mt-4"},[t("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:E}," Cancel "),t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:B}," Update ")])])])):q("",!0)],64))}};export{$e as default};
