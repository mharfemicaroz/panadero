import{J as g,K as O,a as b,s as Q,b as f,c as E,e as V,f as I,h as _,v as J,t as U,m as B,i as e,l as x,B as p,L,F as j,x as z,C as m,S as A}from"./index.81ed66ed.js";import{_ as K}from"./LayoutAuthenticatedX.a0217d4b.js";import{_ as Y}from"./SectionMain.ff7c0a76.js";import{_ as G}from"./NotificationBar.62c87214.js";import{B as W}from"./BaseTable.aa93a529.js";import{_ as X}from"./CardBox.d4dece43.js";import{_ as Z}from"./SectionTitleLineWithButton.9b4305a6.js";import{_ as M}from"./BaseButton.4cf3599a.js";import{p as q,c as ee,u as ae,v as te}from"./mdi.aa269c9f.js";import{A as h}from"./index.822c775f.js";import{u as le}from"./employeeStore.a6304484.js";import"./darkMode.4d354904.js";import"./BaseIcon.f7bbc3f6.js";import"./FormControl.7fdae42f.js";import"./FooterBar.223d3b14.js";import"./logo.c6f18b48.js";import"./BaseLevel.f8579f88.js";import"./TableCheckboxCell.5bd18b8c.js";import"./BaseButtons.e89c9a47.js";import"./_plugin-vue_export-helper.c27b6911.js";const w={async create(r){return(await g.post(`${h}/salaries`,r)).data},async getById(r){return(await g.get(`${h}/salaries/${r}`)).data},async updateById(r,l){return(await g.put(`${h}/salaries/${r}`,l)).data},async delete(r){return(await g.delete(`${h}/salaries/${r}`)).data},async list(r){return(await g.get(`${h}/salaries`,{params:r})).data},async getCurrentSalary(r){return(await g.get(`${h}/salaries/employee/${r}/current`)).data},async getSalaryHistory(r){return(await g.get(`${h}/salaries/employee/${r}/history`)).data},async calculateRates(r){return(await g.post(`${h}/salaries/calculate-rates`,r)).data}},se=O("salary",()=>{const r=b({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),l=b(!1),o=b(null),v=b(!1);return{items:r,isLoading:l,error:o,isLoaded:v,fetchItems:async(c={},d=!1)=>{var s;if(o.value=null,!(!d&&v.value))try{l.value=!0;const y=await w.list(c);Object.assign(r.value,{total:y.total||0,totalPages:y.totalPages||1,currentPage:c.page||1,pageSize:c.limit||10,data:y.data||[]}),v.value=!0}catch(y){o.value=((s=y==null?void 0:y.response)==null?void 0:s.message)||"Failed to fetch salary records"}finally{l.value=!1}},createItem:async c=>{var d;o.value=null;try{l.value=!0;const s=await w.create(c);r.value.data.push(s),r.value.total+=1}catch(s){o.value=((d=s==null?void 0:s.response)==null?void 0:d.message)||"Failed to create salary record"}finally{l.value=!1}},updateItem:async(c,d)=>{var s;o.value=null;try{l.value=!0;const y=await w.updateById(c,d),R=r.value.data.findIndex(D=>D.id===c);R!==-1&&(r.value.data[R]=y)}catch(y){o.value=((s=y==null?void 0:y.response)==null?void 0:s.message)||"Failed to update salary record"}finally{l.value=!1}},deleteItem:async c=>{var d;o.value=null;try{l.value=!0,await w.delete(c),r.value.data=r.value.data.filter(s=>s.id!==c),r.value.total-=1}catch(s){o.value=((d=s==null?void 0:s.response)==null?void 0:d.message)||"Failed to delete salary record"}finally{l.value=!1}},getCurrentSalary:async c=>{var d;o.value=null;try{return l.value=!0,await w.getCurrentSalary(c)}catch(s){o.value=((d=s==null?void 0:s.response)==null?void 0:d.message)||"Failed to fetch current salary"}finally{l.value=!1}},getSalaryHistory:async c=>{var d;o.value=null;try{return l.value=!0,await w.getSalaryHistory(c)}catch(s){o.value=((d=s==null?void 0:s.response)==null?void 0:d.message)||"Failed to fetch salary history"}finally{l.value=!1}},calculateRates:async c=>{var d;o.value=null;try{return l.value=!0,await w.calculateRates(c)}catch(s){o.value=((d=s==null?void 0:s.response)==null?void 0:d.message)||"Failed to calculate salary rates"}finally{l.value=!1}},resetStore:()=>{r.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},v.value=!1,l.value=!1,o.value=null}}}),re={class:"flex items-center gap-2"},oe={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},ne={class:"bg-white p-6 rounded shadow-lg w-[600px]"},ie=e("h2",{class:"text-xl mb-4"},"Add Salary",-1),ue={class:"grid grid-cols-2 gap-4"},de={class:"col-span-2"},ce=e("label",{class:"block mb-1"},"Employee",-1),pe=e("option",{value:"",disabled:""},"Select Employee",-1),me=["value"],ye=e("label",{class:"block mb-1"},"Basic Salary",-1),ve=e("label",{class:"block mb-1"},"Daily Rate",-1),fe=e("label",{class:"block mb-1"},"Hourly Rate",-1),_e=e("label",{class:"block mb-1"},"Overtime Rate",-1),be=e("label",{class:"block mb-1"},"Night Differential Rate",-1),ge=e("label",{class:"block mb-1"},"Holiday Rate",-1),he=e("label",{class:"block mb-1"},"Tax Rate",-1),we=e("label",{class:"block mb-1"},"Effective Date",-1),Se={class:"flex justify-end space-x-2 mt-4"},xe={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},ke={class:"bg-white p-6 rounded shadow-lg w-[600px]"},$e=e("h2",{class:"text-xl mb-4"},"Edit Salary",-1),Ce={class:"grid grid-cols-2 gap-4"},Ve={class:"col-span-2"},Ie=e("label",{class:"block mb-1"},"Employee",-1),Ue=e("option",{value:"",disabled:""},"Select Employee",-1),Re=["value"],Be=e("label",{class:"block mb-1"},"Basic Salary",-1),De=e("label",{class:"block mb-1"},"Daily Rate",-1),Ee=e("label",{class:"block mb-1"},"Hourly Rate",-1),Fe=e("label",{class:"block mb-1"},"Overtime Rate",-1),Pe=e("label",{class:"block mb-1"},"Night Differential Rate",-1),Ne=e("label",{class:"block mb-1"},"Holiday Rate",-1),Te=e("label",{class:"block mb-1"},"Tax Rate",-1),He=e("label",{class:"block mb-1"},"Effective Date",-1),Le={class:"flex justify-end space-x-2 mt-4"},oa={__name:"SalaryView",setup(r){const l=se(),o=le(),v=b([]);o.fetchItems({page:1,limit:100},!0);const k=b(!1),$=b(!1),i=b({employee_id:null,basic_salary:0,daily_rate:0,hourly_rate:0,overtime_rate:1.25,night_differential_rate:1.1,holiday_rate:2,tax_rate:0,effective_date:""}),n=b({id:null,employee_id:null,basic_salary:0,daily_rate:0,hourly_rate:0,overtime_rate:1.25,night_differential_rate:1.1,holiday_rate:2,tax_rate:0,effective_date:""});async function S(u={},t=!1){await l.fetchItems(u,t)}S({page:1,limit:10});const F=Q(()=>{var u,t,a,T,H;return{total:((u=l.items)==null?void 0:u.total)||0,totalPages:((t=l.items)==null?void 0:t.totalPages)||1,currentPage:((a=l.items)==null?void 0:a.currentPage)||1,pageSize:((T=l.items)==null?void 0:T.pageSize)||10,data:(((H=l.items)==null?void 0:H.data)||[]).map(C=>({...C,employee:C.employee?`${C.employee.first_name} ${C.employee.last_name}`:`Employee ${C.employee_id}`}))}}),P=[{key:"employee",label:"Employee",sortable:!0,filterable:!0},{key:"basic_salary",label:"Basic Salary",sortable:!0,filterable:!0},{key:"daily_rate",label:"Daily Rate",sortable:!0,filterable:!0},{key:"overtime_rate",label:"Overtime Rate",sortable:!0,filterable:!0}],N=async u=>{await S(u,!0)},c=u=>{v.value=u},d=async u=>{l.isLoading=!0,n.value={id:u.id,employee_id:u.employee_id,basic_salary:u.basic_salary,daily_rate:u.daily_rate,hourly_rate:u.hourly_rate,overtime_rate:u.overtime_rate,night_differential_rate:u.night_differential_rate,holiday_rate:u.holiday_rate,tax_rate:u.tax_rate,effective_date:u.effective_date},$.value=!0,l.isLoading=!1},s=async()=>{await o.fetchItems({page:1,limit:100},!0),i.value={employee_id:null,basic_salary:0,daily_rate:0,hourly_rate:0,overtime_rate:1.25,night_differential_rate:1.1,holiday_rate:2,tax_rate:0,effective_date:""},k.value=!0};async function y(){await l.createItem(i.value),l.error||(k.value=!1,await S({page:1,limit:10},!0))}async function R(){await l.updateItem(n.value.id,n.value),l.error||($.value=!1,await S({page:1,limit:10},!0))}async function D(){if(v.value.length===0)return;if((await A.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete them!"})).isConfirmed){for(const t of v.value)if(await l.deleteItem(t),l.error)break;l.error||(v.value=[],await S({page:1,limit:10},!0),A.fire("Deleted!","The salary records have been deleted.","success"))}}return(u,t)=>(f(),E(K,null,{default:V(()=>[I(Y,null,{default:V(()=>[_(l).error?(f(),E(G,{key:0,icon:_(q),color:"danger"},{default:V(()=>[J(U(_(l).error),1)]),_:1},8,["icon"])):B("",!0),I(Z,{icon:_(ee),title:"Salaries",main:""},{default:V(()=>[e("div",re,[I(M,{icon:_(ae),color:"primary",label:"New Salary",onClick:s},null,8,["icon"]),v.value.length?(f(),E(M,{key:0,icon:_(te),color:"danger",label:"Delete",onClick:D},null,8,["icon"])):B("",!0)])]),_:1},8,["icon"]),I(X,{class:"mb-6"},{default:V(()=>[I(W,{columns:P,data:F.value,loading:_(l).isLoading,checkable:"",onQueryChange:N,onSelected:c,onEdit:d},null,8,["data","loading"])]),_:1})]),_:1}),k.value?(f(),x("div",oe,[e("div",ne,[ie,e("div",ue,[e("div",de,[ce,p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.employee_id=a),class:"w-full border p-2 rounded"},[pe,(f(!0),x(j,null,z(_(o).items.data,a=>(f(),x("option",{key:a.id,value:a.id},U(a.first_name)+" "+U(a.last_name),9,me))),128))],512),[[L,i.value.employee_id,void 0,{number:!0}]])]),e("div",null,[ye,p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>i.value.basic_salary=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.basic_salary,void 0,{number:!0}]])]),e("div",null,[ve,p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>i.value.daily_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.daily_rate,void 0,{number:!0}]])]),e("div",null,[fe,p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>i.value.hourly_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.hourly_rate,void 0,{number:!0}]])]),e("div",null,[_e,p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>i.value.overtime_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.overtime_rate,void 0,{number:!0}]])]),e("div",null,[be,p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>i.value.night_differential_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.night_differential_rate,void 0,{number:!0}]])]),e("div",null,[ge,p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>i.value.holiday_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.holiday_rate,void 0,{number:!0}]])]),e("div",null,[he,p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>i.value.tax_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,i.value.tax_rate,void 0,{number:!0}]])]),e("div",null,[we,p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>i.value.effective_date=a),type:"date",class:"w-full border p-2 rounded"},null,512),[[m,i.value.effective_date]])])]),e("div",Se,[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:t[9]||(t[9]=a=>k.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:y}," Save ")])])])):B("",!0),$.value?(f(),x("div",xe,[e("div",ke,[$e,e("div",Ce,[e("div",Ve,[Ie,p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>n.value.employee_id=a),class:"w-full border p-2 rounded"},[Ue,(f(!0),x(j,null,z(_(o).items.data,a=>(f(),x("option",{key:a.id,value:a.id},U(a.first_name)+" "+U(a.last_name),9,Re))),128))],512),[[L,n.value.employee_id,void 0,{number:!0}]])]),e("div",null,[Be,p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>n.value.basic_salary=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.basic_salary,void 0,{number:!0}]])]),e("div",null,[De,p(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>n.value.daily_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.daily_rate,void 0,{number:!0}]])]),e("div",null,[Ee,p(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>n.value.hourly_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.hourly_rate,void 0,{number:!0}]])]),e("div",null,[Fe,p(e("input",{"onUpdate:modelValue":t[14]||(t[14]=a=>n.value.overtime_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.overtime_rate,void 0,{number:!0}]])]),e("div",null,[Pe,p(e("input",{"onUpdate:modelValue":t[15]||(t[15]=a=>n.value.night_differential_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.night_differential_rate,void 0,{number:!0}]])]),e("div",null,[Ne,p(e("input",{"onUpdate:modelValue":t[16]||(t[16]=a=>n.value.holiday_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.holiday_rate,void 0,{number:!0}]])]),e("div",null,[Te,p(e("input",{"onUpdate:modelValue":t[17]||(t[17]=a=>n.value.tax_rate=a),type:"number",step:"0.01",class:"w-full border p-2 rounded"},null,512),[[m,n.value.tax_rate,void 0,{number:!0}]])]),e("div",null,[He,p(e("input",{"onUpdate:modelValue":t[18]||(t[18]=a=>n.value.effective_date=a),type:"date",class:"w-full border p-2 rounded"},null,512),[[m,n.value.effective_date]])])]),e("div",Le,[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:t[19]||(t[19]=a=>$.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:R}," Update ")])])])):B("",!0)]),_:1}))}};export{oa as default};
