import{_ as le}from"./LayoutAuthenticatedX.a0217d4b.js";import{_ as se}from"./SectionMain.ff7c0a76.js";import{J as A,K as re,a as v,s as K,b as p,l as h,h as g,c as k,e as S,v as R,t as M,m as C,f as w,i as e,B as G,C as E,L as Y,F as V,x as O,M as J,S as T,n as L}from"./index.81ed66ed.js";import{u as ne}from"./category.bc62a0d5.js";import{A as B}from"./index.8f8d0999.js";import{p as H,u as W,v as X,c as Z}from"./mdi.aa269c9f.js";import{_ as q}from"./NotificationBar.62c87214.js";import{B as ee}from"./BaseTable.aa93a529.js";import{_ as te}from"./CardBox.d4dece43.js";import{_ as ae}from"./SectionTitleLineWithButton.9b4305a6.js";import{_ as U}from"./BaseButton.4cf3599a.js";import ie from"./SubCategoryView.9c77f8a3.js";import"./darkMode.4d354904.js";import"./BaseIcon.f7bbc3f6.js";import"./FormControl.7fdae42f.js";import"./FooterBar.223d3b14.js";import"./logo.c6f18b48.js";import"./BaseLevel.f8579f88.js";import"./TableCheckboxCell.5bd18b8c.js";import"./BaseButtons.e89c9a47.js";import"./_plugin-vue_export-helper.c27b6911.js";const P={async create(n){return(await A.post(`${B}/category-groups`,n)).data},async getById(n){return(await A.get(`${B}/category-groups/${n}`)).data},async updateById(n,t){return(await A.put(`${B}/category-groups/${n}`,t)).data},async delete(n){return(await A.delete(`${B}/category-groups/${n}`)).data},async list(n){return(await A.get(`${B}/category-groups`,{params:n})).data}},oe=re("categoryGroup",()=>{const n=v({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),t=v(!1),l=v(null),u=v(!1);return{items:n,isLoading:t,error:l,isLoaded:u,fetchItems:async(y={},_=!1)=>{var d;if(l.value=null,!(!_&&u.value))try{t.value=!0;const m=await P.list(y);Object.assign(n.value,{total:m.total||0,totalPages:m.totalPages||1,currentPage:y.page||1,pageSize:y.limit||10,data:m.data||[]}),u.value=!0}catch(m){l.value=((d=m==null?void 0:m.response)==null?void 0:d.message)||"Failed to fetch category groups"}finally{t.value=!1}},createItem:async y=>{var _;l.value=null;try{t.value=!0;const d=await P.create(y);n.value.data.push(d),n.value.total+=1}catch(d){l.value=((_=d==null?void 0:d.response)==null?void 0:_.message)||"Failed to create category group"}finally{t.value=!1}},updateItem:async(y,_)=>{var d;l.value=null;try{t.value=!0;const m=await P.updateById(y,_),$=n.value.data.findIndex(N=>N.id===y);$!==-1&&(n.value.data[$]=m)}catch(m){l.value=((d=m==null?void 0:m.response)==null?void 0:d.message)||"Failed to update category group"}finally{t.value=!1}},deleteItem:async y=>{var _;l.value=null;try{t.value=!0,await P.delete(y),n.value.data=n.value.data.filter(d=>d.id!==y),n.value.total-=1}catch(d){l.value=((_=d==null?void 0:d.response)==null?void 0:_.message)||"Failed to delete category group"}finally{t.value=!1}},resetStore:()=>{n.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},u.value=!1,t.value=!1,l.value=null}}}),ue={class:"flex items-center gap-2"},ce={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},de={class:"bg-white p-6 rounded shadow-lg w-96"},pe=e("h2",{class:"text-xl mb-4"},"Add Category",-1),me={class:"mb-4"},ge=e("label",{class:"block mb-1",for:"catName"},"Name",-1),ye={class:"mb-4"},fe=e("label",{class:"block mb-1",for:"catGroupSelect"},"Category Group",-1),ve=e("option",{value:null},"None",-1),be=["value"],_e={class:"mb-4 flex items-center"},he=e("label",{for:"isActive"},"Show in POS?",-1),Ce={key:2,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},we={class:"bg-white p-6 rounded shadow-lg w-96"},xe=e("h2",{class:"text-xl mb-4"},"Edit Category",-1),Ge={class:"mb-4"},ke=e("label",{class:"block mb-1",for:"editCatName"},"Name",-1),Se={class:"mb-4"},$e=e("label",{class:"block mb-1",for:"editCatGroupSelect"},"Category Group",-1),Ne=e("option",{value:null},"None",-1),Ie=["value"],Ae={class:"mb-4 flex items-center"},Be=e("label",{for:"editIsActive"},"Show in POS?",-1),Pe={__name:"CategoryView",setup(n){const t=v(!1),l=v({name:"",categoryGroup:null,isActive:!0}),u=v(!1),c=v({id:null,name:"",categoryGroup:null,isActive:!0}),r=ne(),i=oe(),b=v([]);async function x(a,o=!1){await r.fetchItems(a,o)}x({page:1,limit:5});const y=K(()=>{var a,o,s,I,Q;return{total:((a=r.items)==null?void 0:a.total)||0,totalPages:((o=r.items)==null?void 0:o.totalPages)||1,currentPage:((s=r.items)==null?void 0:s.currentPage)||1,pageSize:((I=r.items)==null?void 0:I.pageSize)||5,data:((Q=r.items)==null?void 0:Q.data)||[]}}),_=[{key:"name",label:"Name",sortable:!0,filterable:!0},{key:"categoryGroup",label:"Category Group",formatter:(a,o)=>o.categoryGroup?o.categoryGroup.name:""}],d=async a=>{await x(a,!0)},m=a=>{b.value=a},$=async a=>{await i.fetchItems(),c.value={id:a.id,name:a.name,categoryGroup:a.categoryGroup?a.categoryGroup.id:null,isActive:a.isActive??!0},u.value=!0},N=async()=>{await i.fetchItems(),l.value={name:"",categoryGroup:null,isActive:!0},t.value=!0};async function F(){await r.createItem({name:l.value.name,categoryGroupId:l.value.categoryGroup,isActive:l.value.isActive}),r.error||(t.value=!1,await x({page:1,limit:5},!0))}async function j(){await r.updateItem(c.value.id,{name:c.value.name,categoryGroupId:c.value.categoryGroup,isActive:c.value.isActive}),r.error||(u.value=!1,await x({page:1,limit:5},!0))}async function D(){if(!(!b.value.length||!(await T.fire({title:"Are you sure?",text:`You are about to delete ${b.value.length} selected categories. This action cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)){for(const o of b.value)if(await r.deleteItem(o),r.error)break;r.error||(b.value=[],await x({page:1,limit:5},!0),T.fire({icon:"success",title:"Deleted!",text:"Selected categories have been deleted.",timer:1500,showConfirmButton:!1}))}}const z=()=>{t.value=!1},f=()=>{u.value=!1};return(a,o)=>(p(),h(V,null,[g(r).error?(p(),k(q,{key:0,icon:g(H),color:"danger"},{default:S(()=>[R(M(g(r).error),1)]),_:1},8,["icon"])):C("",!0),w(ae,{icon:g(Z),title:"Category",main:""},{default:S(()=>[e("div",ue,[w(U,{icon:g(W),color:"primary",label:"New Category",onClick:N},null,8,["icon"]),b.value.length?(p(),k(U,{key:0,icon:g(X),color:"danger",label:"Delete",onClick:D},null,8,["icon"])):C("",!0)])]),_:1},8,["icon"]),w(te,{class:"mb-6"},{default:S(()=>[w(ee,{columns:_,data:y.value,loading:g(r).isLoading,checkable:"",onQueryChange:d,onSelected:m,onEdit:$},null,8,["data","loading"])]),_:1}),t.value?(p(),h("div",ce,[e("div",de,[pe,e("div",me,[ge,G(e("input",{id:"catName","onUpdate:modelValue":o[0]||(o[0]=s=>l.value.name=s),type:"text",class:"w-full border p-2 rounded"},null,512),[[E,l.value.name]])]),e("div",ye,[fe,G(e("select",{id:"catGroupSelect","onUpdate:modelValue":o[1]||(o[1]=s=>l.value.categoryGroup=s),class:"w-full border p-2 rounded"},[ve,(p(!0),h(V,null,O(g(i).items.data,s=>(p(),h("option",{key:s.id,value:s.id},M(s.name),9,be))),128))],512),[[Y,l.value.categoryGroup]])]),e("div",_e,[G(e("input",{id:"isActive",type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=s=>l.value.isActive=s),class:"mr-2"},null,512),[[J,l.value.isActive]]),he]),e("div",{class:"flex justify-end space-x-2"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:z},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:F}," Save ")])])])):C("",!0),u.value?(p(),h("div",Ce,[e("div",we,[xe,e("div",Ge,[ke,G(e("input",{id:"editCatName","onUpdate:modelValue":o[3]||(o[3]=s=>c.value.name=s),type:"text",class:"w-full border p-2 rounded"},null,512),[[E,c.value.name]])]),e("div",Se,[$e,G(e("select",{id:"editCatGroupSelect","onUpdate:modelValue":o[4]||(o[4]=s=>c.value.categoryGroup=s),class:"w-full border p-2 rounded"},[Ne,(p(!0),h(V,null,O(g(i).items.data,s=>(p(),h("option",{key:s.id,value:s.id},M(s.name),9,Ie))),128))],512),[[Y,c.value.categoryGroup]])]),e("div",Ae,[G(e("input",{id:"editIsActive",type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=s=>c.value.isActive=s),class:"mr-2"},null,512),[[J,c.value.isActive]]),Be]),e("div",{class:"flex justify-end space-x-2"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:f}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:j}," Update ")])])])):C("",!0)],64))}},Me={class:"flex items-center gap-2"},Ve={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},Ee={class:"bg-white p-6 rounded shadow-lg w-96"},Te=e("h2",{class:"text-xl mb-4"},"New Category Group",-1),Ue={class:"mb-4"},Fe=e("label",{class:"block mb-1",for:"groupName"},"Name",-1),je={key:2,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},De={class:"bg-white p-6 rounded shadow-lg w-96"},ze=e("h2",{class:"text-xl mb-4"},"Edit Category Group",-1),Le={class:"mb-4"},Qe=e("label",{class:"block mb-1",for:"editGroupName"},"Name",-1),Ye={__name:"CategoryGroupView",setup(n){const t=v(!1),l=v({name:""}),u=v(!1),c=v({id:null,name:""}),r=v([]),i=oe();async function b(f,a=!1){await i.fetchItems(f,a)}b({page:1,limit:5});const x=K(()=>{var f,a,o,s,I;return{total:((f=i.items)==null?void 0:f.total)||0,totalPages:((a=i.items)==null?void 0:a.totalPages)||1,currentPage:((o=i.items)==null?void 0:o.currentPage)||1,pageSize:((s=i.items)==null?void 0:s.pageSize)||5,data:((I=i.items)==null?void 0:I.data)||[]}}),y=[{key:"name",label:"Name",sortable:!0,filterable:!0}],_=async f=>{await b(f,!0)},d=f=>{r.value=f},m=f=>{c.value={id:f.id,name:f.name},u.value=!0};function $(){l.value={name:""},t.value=!0}async function N(){await i.createItem(l.value),i.error||(t.value=!1,await b({page:1,limit:5},!0))}async function F(){await i.updateItem(c.value.id,{name:c.value.name}),i.error||(u.value=!1,await b({page:1,limit:5},!0))}async function j(){if(!(!r.value.length||!(await T.fire({title:"Are you sure?",text:`You are about to delete ${r.value.length} selected category groups. This action cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"Cancel",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"})).isConfirmed)){for(const a of r.value)if(await i.deleteItem(a),i.error)break;i.error||(r.value=[],await b({page:1,limit:5},!0),T.fire({icon:"success",title:"Deleted!",text:"Selected category groups have been deleted.",timer:1500,showConfirmButton:!1}))}}function D(){t.value=!1}function z(){u.value=!1}return(f,a)=>(p(),h(V,null,[g(i).error?(p(),k(q,{key:0,icon:g(H),color:"danger"},{default:S(()=>[R(M(g(i).error),1)]),_:1},8,["icon"])):C("",!0),w(ae,{icon:g(Z),title:"Category Group",main:""},{default:S(()=>[e("div",Me,[w(U,{icon:g(W),color:"primary",label:"New Category Group",onClick:$},null,8,["icon"]),r.value.length?(p(),k(U,{key:0,icon:g(X),color:"danger",label:"Delete",onClick:j},null,8,["icon"])):C("",!0)])]),_:1},8,["icon"]),w(te,{class:"mb-6"},{default:S(()=>[w(ee,{columns:y,data:x.value,loading:g(i).isLoading,checkable:"",onQueryChange:_,onSelected:d,onEdit:m},null,8,["data","loading"])]),_:1}),t.value?(p(),h("div",Ve,[e("div",Ee,[Te,e("div",Ue,[Fe,G(e("input",{id:"groupName",type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>l.value.name=o),class:"w-full border p-2 rounded"},null,512),[[E,l.value.name]])]),e("div",{class:"flex justify-end space-x-2"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:D},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:N}," Save ")])])])):C("",!0),u.value?(p(),h("div",je,[e("div",De,[ze,e("div",Le,[Qe,G(e("input",{id:"editGroupName",type:"text","onUpdate:modelValue":a[1]||(a[1]=o=>c.value.name=o),class:"w-full border p-2 rounded"},null,512),[[E,c.value.name]])]),e("div",{class:"flex justify-end space-x-2"},[e("button",{class:"px-4 py-2 bg-gray-200 rounded",onClick:z},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:F}," Update ")])])])):C("",!0)],64))}},Oe={class:"overflow-x-auto"},Je={class:"flex space-x-4 border-b mb-4 whitespace-nowrap"},gt={__name:"CategoryMainView",setup(n){const t=v("category_group");return(l,u)=>(p(),k(le,null,{default:S(()=>[w(se,null,{default:S(()=>[e("div",Oe,[e("div",Je,[e("button",{class:L(["px-4 py-2 font-semibold focus:outline-none",t.value==="category_group"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"]),onClick:u[0]||(u[0]=c=>t.value="category_group")}," Category Group ",2),e("button",{class:L(["px-4 py-2 font-semibold focus:outline-none",t.value==="category"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"]),onClick:u[1]||(u[1]=c=>t.value="category")}," Category ",2),e("button",{class:L(["px-4 py-2 font-semibold focus:outline-none",t.value==="subcategory"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"]),onClick:u[2]||(u[2]=c=>t.value="subcategory")}," Subcategory ",2)])]),t.value==="category_group"?(p(),k(Ye,{key:0})):t.value==="category"?(p(),k(Pe,{key:1})):t.value==="subcategory"?(p(),k(ie,{key:2})):C("",!0)]),_:1})]),_:1}))}};export{gt as default};
