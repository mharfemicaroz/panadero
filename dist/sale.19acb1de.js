import{J as c,K as m,a as p}from"./index.a2c9f28c.js";import{A as i}from"./index.77c7a69c.js";const d={async list(a){return(await c.get(`${i}/sales`,{params:a})).data},async create(a){return(await c.post(`${i}/sales`,a)).data},async getById(a){return(await c.get(`${i}/sales/${a}`)).data},async updateById(a,r){return(await c.put(`${i}/sales/${a}`,r)).data},async delete(a){return(await c.delete(`${i}/sales/${a}`)).data},async complete(a){return(await c.put(`${i}/sales/${a}/complete`)).data},async getTotalForShift(a){return(await c.get(`${i}/sales/${a}/total`)).data}},T=m("sale",()=>{const a=p({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),r=p(null),n=p(!1),o=p(null),v=p(!1);return{items:a,item:r,isLoading:n,error:o,isLoaded:v,fetchItems:async(s={},l=!1)=>{var t,e;if(o.value=null,!(!l&&v.value))try{n.value=!0;const u=await d.list(s);Object.assign(a.value,{total:u.total||0,totalPages:u.totalPages||1,currentPage:s.page||1,pageSize:s.limit||10,data:u.data||[]}),v.value=!0}catch(u){o.value=((e=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to fetch sales"}finally{n.value=!1}},fetchItemById:async s=>{var l,t;o.value=null;try{n.value=!0;const e=await d.getById(s);r.value=e}catch(e){o.value=((t=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to fetch sale"}finally{n.value=!1}},createItem:async s=>{var l,t;o.value=null;try{n.value=!0;const e=await d.create(s);return a.value.data.push(e),a.value.total+=1,e}catch(e){o.value=((t=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to create sale"}finally{n.value=!1}},updateItem:async(s,l)=>{var t,e;o.value=null;try{n.value=!0;const u=await d.updateById(s,l),f=a.value.data.findIndex(y=>y.id===s);f!==-1&&(a.value.data[f]=u)}catch(u){o.value=((e=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to update sale"}finally{n.value=!1}},deleteItem:async s=>{var l,t;o.value=null;try{n.value=!0,await d.delete(s),a.value.data=a.value.data.filter(e=>e.id!==s),a.value.total-=1}catch(e){o.value=((t=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to delete sale"}finally{n.value=!1}},completeItem:async s=>{var l,t;o.value=null;try{n.value=!0;const e=await d.complete(s),u=a.value.data.findIndex(f=>f.id===s);u!==-1&&(a.value.data[u]=e)}catch(e){o.value=((t=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to complete sale"}finally{n.value=!1}},getTotalForShift:async s=>{var l,t;o.value=null;try{return n.value=!0,(await d.getTotalForShift(s)).totalSales}catch(e){return o.value=((t=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to fetch total sales for shift",0}finally{n.value=!1}},resetStore:()=>{a.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},r.value=null,n.value=!1,o.value=null,v.value=!1}}});export{T as u};
