import{J as c,K as y,a as d}from"./index.dc23916b.js";const i={async create(e){return(await c.post("/users",e)).data},async getById(e){return(await c.get(`/users/${e}`)).data},async updateById(e,t){return(await c.put(`/users/${e}`,t)).data},async delete(e){return(await c.delete(`/users/${e}`)).data},async list(e){return(await c.get("/users",{params:e})).data}},F=y("user",()=>{const e=d({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),t=d(!1),u=d(null),v=d(!1),r=d(null);return{users:e,selectedUser:r,isLoading:t,error:u,isLoaded:v,fetchAll:async(l={},n=!1)=>{var a;if(u.value=null,!(!n&&v.value))try{t.value=!0;const s=await i.list(l);Object.assign(e.value,{total:s.total||0,totalPages:s.totalPages||1,currentPage:l.page||1,pageSize:l.limit||10,data:s.data||[]}),v.value=!0}catch(s){u.value=((a=s==null?void 0:s.response)==null?void 0:a.message)||"Failed to fetch users"}finally{t.value=!1}},fetchById:async l=>{var n;u.value=null;try{t.value=!0;const a=await i.getById(l);r.value=a}catch(a){u.value=((n=a==null?void 0:a.response)==null?void 0:n.message)||"Failed to fetch user"}finally{t.value=!1}},create:async l=>{var n;u.value=null;try{t.value=!0;const a=await i.create(l);e.value.data.push(a),e.value.total+=1}catch(a){u.value=((n=a==null?void 0:a.response)==null?void 0:n.message)||"Failed to create user"}finally{t.value=!1}},updateById:async(l,n)=>{var a,s;u.value=null;try{t.value=!0;const o=await i.updateById(l,n),p=e.value.data.findIndex(f=>f.id===l);p!==-1&&(e.value.data[p]=o),((a=r.value)==null?void 0:a.id)===l&&(r.value=o)}catch(o){u.value=((s=o==null?void 0:o.response)==null?void 0:s.message)||"Failed to update user"}finally{t.value=!1}},deleteById:async l=>{var n,a;u.value=null;try{t.value=!0,await i.delete(l),e.value.data=e.value.data.filter(s=>s.id!==l),e.value.total-=1,((n=r.value)==null?void 0:n.id)===l&&(r.value=null)}catch(s){u.value=((a=s==null?void 0:s.response)==null?void 0:a.message)||"Failed to delete user"}finally{t.value=!1}},resetStore:()=>{e.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},r.value=null,v.value=!1,t.value=!1,u.value=null}}});export{F as u};
