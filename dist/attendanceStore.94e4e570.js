import{J as o,K as y,a as i}from"./index.c3b8df4f.js";import{A as r}from"./index.7ee928b2.js";const u={async create(a){return(await o.post(`${r}/attendances`,a)).data},async getById(a){return(await o.get(`${r}/attendances/${a}`)).data},async updateById(a,t){return(await o.put(`${r}/attendances/${a}`,t)).data},async delete(a){return(await o.delete(`${r}/attendances/${a}`)).data},async list(a){return(await o.get(`${r}/attendances`,{params:a})).data},async getDailyAttendance(a){return(await o.get(`${r}/attendances/daily/${a}`)).data},async computeAttendance(a){return(await o.post(`${r}/attendances/compute/${a}`)).data}},F=y("attendance",()=>{const a=i({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),t=i(!1),n=i(null),d=i(!1);return{items:a,isLoading:t,error:n,isLoaded:d,fetchItems:async(s={},l=!1)=>{var e;if(n.value=null,!(!l&&d.value))try{t.value=!0;const c=await u.list(s);Object.assign(a.value,{total:c.total||0,totalPages:c.totalPages||1,currentPage:s.page||1,pageSize:s.limit||10,data:c.data||[]}),d.value=!0}catch(c){n.value=((e=c==null?void 0:c.response)==null?void 0:e.message)||"Failed to fetch attendance records"}finally{t.value=!1}},createItem:async s=>{var l;n.value=null;try{t.value=!0;const e=await u.create(s);a.value.data.push(e),a.value.total+=1}catch(e){n.value=((l=e==null?void 0:e.response)==null?void 0:l.message)||"Failed to create attendance record"}finally{t.value=!1}},updateItem:async(s,l)=>{var e;n.value=null;try{t.value=!0;const c=await u.updateById(s,l),p=a.value.data.findIndex(v=>v.id===s);p!==-1&&(a.value.data[p]=c)}catch(c){n.value=((e=c==null?void 0:c.response)==null?void 0:e.message)||"Failed to update attendance record"}finally{t.value=!1}},deleteItem:async s=>{var l;n.value=null;try{t.value=!0,await u.delete(s),a.value.data=a.value.data.filter(e=>e.id!==s),a.value.total-=1}catch(e){n.value=((l=e==null?void 0:e.response)==null?void 0:l.message)||"Failed to delete attendance record"}finally{t.value=!1}},getDailyAttendance:async s=>{var l;n.value=null;try{return t.value=!0,await u.getDailyAttendance(s)}catch(e){n.value=((l=e==null?void 0:e.response)==null?void 0:l.message)||"Failed to fetch daily attendance"}finally{t.value=!1}},computeAttendance:async s=>{var l;n.value=null;try{return t.value=!0,await u.computeAttendance(s)}catch(e){n.value=((l=e==null?void 0:e.response)==null?void 0:l.message)||"Failed to compute attendance"}finally{t.value=!1}},resetStore:()=>{a.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},d.value=!1,t.value=!1,n.value=null}}});export{F as u};
