import{a as k,q as W,s as m,b as _,c as S,e as g,i as o,h as i,v as A,t as Q,m as L,f as s,B as U,L as z,l as D,x as E,F as Y}from"./index.a2c9f28c.js";import{_ as j}from"./LayoutAuthenticatedX.d58fd7d8.js";import{_ as G}from"./NotificationBar.caa84e93.js";import{B as w}from"./BaseTable.a063d648.js";import{_ as C}from"./CardBox.25a3dc7a.js";import{_ as I}from"./SectionTitleLineWithButton.39476921.js";import{_ as H}from"./BaseButton.b8e12a74.js";import{V as J}from"./main.be0db63c.js";import{u as K}from"./inventory.97e4a13c.js";import{u as X}from"./warehouse.0c6d3805.js";import"./mdi.aa269c9f.js";import"./darkMode.b88882a1.js";import"./BaseIcon.ad3a4017.js";import"./FormControl.2759acc3.js";import"./FooterBar.948c11c8.js";import"./logo.c6f18b48.js";import"./BaseLevel.e0eed931.js";import"./TableCheckboxCell.8ab5003b.js";import"./BaseButtons.e7208c74.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./index.77c7a69c.js";const Z={class:"p-4"},tt={class:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded shadow-sm"},et={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},at=o("label",{class:"block text-sm font-medium text-gray-700"},"Select Date Range",-1),nt=o("label",{class:"block text-sm font-medium text-gray-700"},"Select Warehouse",-1),ot=o("option",{value:""},"All Warehouses",-1),st=["value"],lt={class:"flex items-end"},xt={__name:"InventorySummaryReport",setup(rt){const n=K(),b=X(),r=k([new Date,new Date]),c=k("");function x(t){const e=new Date(t),a=e.getFullYear(),d=(e.getMonth()+1).toString().padStart(2,"0"),u=e.getDate().toString().padStart(2,"0");return`${a}-${d}-${u}T00:00:00`}function $(t){const e=new Date(t),a=e.getFullYear(),d=(e.getMonth()+1).toString().padStart(2,"0"),u=e.getDate().toString().padStart(2,"0");return`${a}-${d}-${u}T23:59:59`}async function p(t={},e=!1){await n.fetchItems(t,e)}async function B(){await b.fetchAll({},!0)}W(()=>{B(),p({page:1,limit:10},!0)});const h=m(()=>n.items.data.map(t=>{const e=t.item?t.item.beginning_qty:0,{totalIn:a,addedQty:d}=(t.stock_movements||[]).reduce((l,{type:f,note:v,quantity_change:y})=>(f==="IN"&&(v==="manual deduct"?l.totalIn+=y:l.addedQty+=y),l),{totalIn:0,addedQty:0}),{totalOut:u,deductQty:O}=(t.stock_movements||[]).reduce((l,{type:f,note:v,quantity_change:y})=>(f==="OUT"&&(v==="manual deduct"?l.deductQty+=y:l.totalOut+=y),l),{totalOut:0,deductQty:0}),R=u;return{item:t.item?t.item.name:"",category:t.item&&t.item.category?t.item.category.name:"",beginning_qty:e,added_qty:d,purchased_qty:a,deduct_qty:O,sales_qty:R,current_qty:t.current_quantity}})),V=m(()=>({total:n.items.total||0,totalPages:n.items.totalPages||1,currentPage:n.items.currentPage||1,pageSize:n.items.pageSize||10,data:h.value})),q=m(()=>{const t={};return h.value.forEach(e=>{const a=e.category||"Uncategorized";t[a]||(t[a]={category:a,beginning_qty:0,added_qty:0,purchased_qty:0,deduct_qty:0,sales_qty:0,current_qty:0}),t[a].beginning_qty+=e.beginning_qty,t[a].added_qty+=e.added_qty,t[a].purchased_qty+=e.purchased_qty,t[a].deduct_qty+=e.deduct_qty,t[a].sales_qty+=e.sales_qty,t[a].current_qty+=e.current_qty}),Object.values(t)}),T=m(()=>({total:q.value.length,data:q.value})),F=[{key:"item",label:"Item"},{key:"category",label:"Category"},{key:"beginning_qty",label:"Beginning Qty"},{key:"added_qty",label:"Added Qty"},{key:"purchased_qty",label:"Purchased Qty"},{key:"deduct_qty",label:"Deduct Qty"},{key:"sales_qty",label:"Sales Qty"},{key:"current_qty",label:"Current Qty"}],M=[{key:"category",label:"Category"},{key:"beginning_qty",label:"Beginning Qty"},{key:"added_qty",label:"Added Qty"},{key:"purchased_qty",label:"Purchased Qty"},{key:"deduct_qty",label:"Deduct Qty"},{key:"sales_qty",label:"Sales Qty"},{key:"current_qty",label:"Current Qty"}],P=async()=>{let t="",e="";r.value&&r.value.length===2&&(t=x(r.value[0]),e=$(r.value[1]));const a={};t&&(a["filters[start_date]"]=t),e&&(a["filters[end_date]"]=e),c.value&&(a["filters[warehouse_id]"]=c.value),await p({...a,page:1,limit:10},!0)},N=async t=>{await p(t,!0)};return(t,e)=>(_(),S(j,null,{default:g(()=>[o("div",Z,[i(n).error?(_(),S(G,{key:0,color:"danger"},{default:g(()=>[A(Q(i(n).error),1)]),_:1})):L("",!0),s(I,{title:"Inventory Summary Report",main:""}),o("div",tt,[o("div",et,[o("div",null,[at,s(i(J),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),range:"","multi-calendars":"",format:"yyyy-MM-dd","input-class":"mt-1 block w-full rounded border-gray-300 shadow-sm"},null,8,["modelValue"])]),o("div",null,[nt,U(o("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),class:"mt-1 block w-full rounded border-gray-300 shadow-sm"},[ot,(_(!0),D(Y,null,E(i(b).warehouses,a=>(_(),D("option",{key:a.id,value:a.id},Q(a.name),9,st))),128))],512),[[z,c.value]])]),o("div",lt,[s(H,{label:"Filter",color:"blue",class:"px-4 py-2",onClick:P})])])]),s(C,{class:"mb-6"},{default:g(()=>[s(w,{columns:F,data:V.value,loading:i(n).isLoading,"show-action":!1,onQueryChange:N},null,8,["data","loading"])]),_:1}),s(I,{title:"Inventory Summary By Category",main:""}),s(C,{class:"mb-6"},{default:g(()=>[s(w,{columns:M,data:T.value,loading:i(n).isLoading,"show-action":!1},null,8,["data","loading"])]),_:1})])]),_:1}))}};export{xt as default};
